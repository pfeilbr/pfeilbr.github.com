<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0"
    xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>s3 on Brian Pfeil</title>
        <link>https://brianpfeil.com/tags/s3/</link>
        <description>Recent content in s3 on Brian Pfeil</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Wed, 11 Nov 2020 00:00:00 -0500</lastBuildDate><atom:link href="https://brianpfeil.com/tags/s3/index.xml" rel="self" type="application/rss+xml" />
    <item>
<title>DynamoDB Export to S3 and Query with Athena</title>
<link>https://brianpfeil.com/post/dynamodb-export-to-s3-and-query-with-athena/</link>
<pubDate>Wed, 11 Nov 2020 00:00:00 -0500</pubDate>
      
      <guid>https://brianpfeil.com/post/dynamodb-export-to-s3-and-query-with-athena/</guid>
<description>&lt;div class=&#34;alert alert-info small bg-info&#34; role=&#34;alert&#34;&gt;
&lt;span class=&#34;text-muted&#34;&gt;code for article&lt;/span&gt;&amp;nbsp;&lt;a href=&#34;https://github.com/pfeilbr/dynamodb-export-to-s3-and-query-with-athena-playground&#34; target=&#34;_blank&#34;&gt;&lt;i class=&#34;fab fa-github fa-sm&#34;&gt;&lt;/i&gt;&amp;nbsp;pfeilbr/dynamodb-export-to-s3-and-query-with-athena-playground&lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;example exporting dynamodb table to S3 and then querying via athena&lt;/p&gt;
&lt;h2 id=&#34;files&#34;&gt;Files&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;template.yaml&#34;&gt;&lt;code&gt;template.yaml&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;main.sh&#34;&gt;&lt;code&gt;main.sh&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;example-export&#34;&gt;&lt;code&gt;example-export/&lt;/code&gt;&lt;/a&gt; - example contents of export (copied from S3)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;running&#34;&gt;Running&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;sam deploy --guided
&lt;span class=&#34;c1&#34;&gt;# note: seed data is generated as part of deploy via cfn custom resource `Custom::SeedData`&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# which triggers a lambda which populates the dynamodb table&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# update `STACK_NAME` variable in ./main.sh&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# run export table to s3 script&lt;/span&gt;
./main.sh

aws dynamodb list-exports &lt;span class=&#34;c1&#34;&gt;# in progress&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportSummaries&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportArn&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;arn:aws:dynamodb:us-east-1:529276214230:table/dynamodb-export-to-s3-and-query-with-athena-playground-v2-MyTable-1WGSJ3W2WJWPK/export/01605130432834-8a918b87&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportStatus&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;IN_PROGRESS&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;aws dynamodb list-exports &lt;span class=&#34;c1&#34;&gt;# completed&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportSummaries&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportArn&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;arn:aws:dynamodb:us-east-1:529276214230:table/dynamodb-export-to-s3-and-query-with-athena-playground-v2-MyTable-1WGSJ3W2WJWPK/export/01605130432834-8a918b87&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;ExportStatus&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;COMPLETED&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Example export file contents (line delimited json items)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gzcat example-export/demo_prefix/AWSDynamoDB/01605130432834-8a918b87/data/vajn3deidy4svdja3fgej2ynay.json.gz&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Item&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;pk&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pk001-1605121017583&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;sk&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sk001&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}}}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Item&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;pk&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pk002-1605121017583&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;sk&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sk002&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Access Exported Data in S3 via Athena&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;c1&#34;&gt;-- Create external table in athena pointing to exported S3 data
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CREATE&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;TABLE&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;IF&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;NOT&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;EXISTS&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ddb_exported_table&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;Item&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;S&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
               &lt;span class=&#34;n&#34;&gt;sk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;S&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;ROW&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FORMAT&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SERDE&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;org.openx.data.jsonserde.JsonSerDe&amp;#39;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;LOCATION&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;s3://dynamodb-export-to-s3-and-query-with-exportbucket-103kukqwmab7n/demo_prefix/AWSDynamoDB/01605130432834-8a918b87/data/&amp;#39;&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;TBLPROPERTIES&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;has_encrypted_data&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;true&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;-- issues SELECT query
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;S&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;Item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;S&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sk&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ddb_exported_table&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Screenshot from Athena Console&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAH1H1K1GLJAp72MXnQvHCiOBLxptt9FkrYB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;resources&#34;&gt;Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/blogs/aws/new-export-amazon-dynamodb-table-data-to-data-lake-amazon-s3/&#34;&gt;New – Export Amazon DynamoDB Table Data to Your Data Lake in Amazon S3, No Code Writing Required&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/about-aws/whats-new/2020/11/now-you-can-export-your-amazon-dynamodb-table-data-to-your-data-lake-in-amazon-s3-to-perform-analytics-at-any-scale/&#34;&gt;Now you can export your Amazon DynamoDB table data to your data lake in Amazon S3 to perform analytics at any scale&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DataExport.html&#34;&gt;Exporting DynamoDB table data to Amazon S3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/blogs/infrastructure-and-automation/aws-cloudformation-custom-resource-creation-with-python-aws-lambda-and-crhelper/&#34;&gt;AWS CloudFormation custom resource creation with Python, AWS Lambda, and crhelper&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
</item>
    
    <item>
<title>S3 Access Points</title>
<link>https://brianpfeil.com/post/s3-access-points/</link>
<pubDate>Thu, 01 Oct 2020 00:00:00 -0400</pubDate>
      
      <guid>https://brianpfeil.com/post/s3-access-points/</guid>
<description>&lt;div class=&#34;alert alert-info small bg-info&#34; role=&#34;alert&#34;&gt;
&lt;span class=&#34;text-muted&#34;&gt;code for article&lt;/span&gt;&amp;nbsp;&lt;a href=&#34;https://github.com/pfeilbr/s3-access-points-playground&#34; target=&#34;_blank&#34;&gt;&lt;i class=&#34;fab fa-github fa-sm&#34;&gt;&lt;/i&gt;&amp;nbsp;pfeilbr/s3-access-points-playground&lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;learn &lt;a href=&#34;https://aws.amazon.com/s3/features/access-points/&#34;&gt;S3 Access Points&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Be sure to review &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/access-points-restrictions-limitations.html&#34;&gt;Access points restrictions and limitations&lt;/a&gt; before considering for a use case.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;feature-overview&#34;&gt;Feature Overview&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Access points are unique hostnames&lt;/li&gt;
&lt;li&gt;enforce distinct permissions and network controls for any request made through the access point.&lt;/li&gt;
&lt;li&gt;Customers with shared data sets scale access for hundreds of applications by creating individualized access points with names and permissions customized for each application.&lt;/li&gt;
&lt;li&gt;access point can be restricted to a VPC to firewall S3 data access within customers’ private networks&lt;/li&gt;
&lt;li&gt;AWS Service Control Policies can be used to ensure all access points are VPC restricted.&lt;/li&gt;
&lt;li&gt;no longer have to manage a single, complex bucket policy with hundreds of different permission rules that need to be written, read, tracked, and audited. With S3 Access Points, you can now create application-specific access points permitting access to shared data sets with policies tailored to the specific application.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;example&#34;&gt;Example&lt;/h2&gt;
&lt;h3 id=&#34;policy&#34;&gt;Policy&lt;/h3&gt;
&lt;p&gt;limit access to &lt;code&gt;partner-01&lt;/code&gt; role&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;Version&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;2012-10-17&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;Statement&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;Sid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;AllObjectActions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;Effect&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Allow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;Principal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;#34;AWS&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;arn:aws:iam::529276214230:role/partner-01&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;Action&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;s3:*Object&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;#34;Resource&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;arn:aws:s3:us-east-1:529276214230:accesspoint/partner-01-read-write/object/*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Access Point Hostname&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://partner-01-read-write-529276214230.s3-accesspoint.us-east-1.amazonaws.com&#34;&gt;https://partner-01-read-write-529276214230.s3-accesspoint.us-east-1.amazonaws.com&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;example-usage&#34;&gt;Example Usage&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# get `a.c` using `partner-01` role&lt;/span&gt;
aws --profile partner-01 s3api get-object --key a.c --bucket &lt;span class=&#34;s1&#34;&gt;&amp;#39;arn:aws:s3:us-east-1:529276214230:accesspoint/partner-01-read-write&amp;#39;&lt;/span&gt; -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;resources&#34;&gt;Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/s3/features/access-points/&#34;&gt;S3 | Access Points&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/blogs/aws/easily-manage-shared-data-sets-with-amazon-s3-access-points/&#34;&gt;Easily Manage Shared Data Sets with Amazon S3 Access Points&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/access-points-restrictions-limitations.html&#34;&gt;Access points restrictions and limitations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tutorialsdojo.com/amazon-s3-access-points/&#34;&gt;Amazon S3 Access Points - Tutorials Dojo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;screenshots&#34;&gt;Screenshots&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;get via access point example&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAEIrh66-vdOzK64ivOI8xfAt-faNQtoD7oB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;access point details&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAEnQBgUUfFEv4dIUyMwL-HP-8Hg1Wy9fB4B/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;access point policy&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAFROvTnHs9FfqI5GuYJL3wzurnVtZMLHa0B/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;partner-01&lt;/code&gt; role&lt;/strong&gt; &lt;em&gt;(requires S3 read permissions)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAHGcyrA7vNGfrBQQy1AvkTFK0K8DzBVQt4B/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;scratch&#34;&gt;Scratch&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ~/tmp
aws s3 cp a.c s3://s3-access-points-playground/

&lt;span class=&#34;c1&#34;&gt;# verify assume role works&lt;/span&gt;
aws --profile partner-01 sts get-caller-identity

aws --profile partner-01 s3api get-object --key a.c --bucket &lt;span class=&#34;s1&#34;&gt;&amp;#39;arn:aws:s3:us-east-1:529276214230:accesspoint/partner-01-read-write&amp;#39;&lt;/span&gt; -

aws --profile partner-01 sts get-caller-identity

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
</item>
    
    <item>
<title>AWS AppFlow Veeva Vault to S3</title>
<link>https://brianpfeil.com/post/aws-appflow-veeva-vault-to-s3/</link>
<pubDate>Tue, 08 Sep 2020 00:00:00 -0400</pubDate>
      
      <guid>https://brianpfeil.com/post/aws-appflow-veeva-vault-to-s3/</guid>
<description>&lt;div class=&#34;alert alert-info small bg-info&#34; role=&#34;alert&#34;&gt;
&lt;span class=&#34;text-muted&#34;&gt;code for article&lt;/span&gt;&amp;nbsp;&lt;a href=&#34;https://github.com/pfeilbr/aws-appflow-veeva-vault-to-s3-playground&#34; target=&#34;_blank&#34;&gt;&lt;i class=&#34;fab fa-github fa-sm&#34;&gt;&lt;/i&gt;&amp;nbsp;pfeilbr/aws-appflow-veeva-vault-to-s3-playground&lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a href=&#34;https://aws.amazon.com/appflow/&#34;&gt;AWS AppFlow&lt;/a&gt; example of Veeva Vault data -&amp;gt; AppFlow -&amp;gt; S3.&lt;/p&gt;
&lt;h2 id=&#34;notes&#34;&gt;Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;no events from Vault.  only poll / query existing data manually/on demand or schedule.
&lt;img src=&#34;https://www.evernote.com/l/AAF3BbJNMHdIaLNUl9hNZAHO8Zr3e7bSZ1MB/image.png&#34; alt=&#34;&#34;&gt;&lt;/li&gt;
&lt;li&gt;at the time (2020-09-08) EventBridge was not available as a destination.
&lt;ul&gt;
&lt;li&gt;available destinations: redshift, s3, salesforce&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;screenshot-tour&#34;&gt;Screenshot Tour&lt;/h2&gt;
&lt;p&gt;veeva vault data source general information&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAE4K0xTZj9ISLsONEom0QqFaIaMVLrjUnsB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAHUtXCllmhCcL9GDEM3niCGEzB9JgG-3OsB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;veeva vault org&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAGxHwv8cW9MeIDr3Cz9Duqg7wr5Oj6ukrkB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;veeva vault connection&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAHRq_vW-vNLlIsvbObynfHTqtZdZz1Q1gAB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;source -&amp;gt; destination&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAFCvNEVU0BN-YZKQZibgPJBqJzrMcfs0LEB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;mapping&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAFUFvxxDcVJJLSOtBohXBcELSRI6VQrC7cB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAGCQd2v2sVAe4sOxBweWzz-O6iZdj93ENYB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;created&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAHfQEEVKGFNVbg_ir7aBoxYBVwjhYcpDZkB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;run history&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAEW45w_DDJIgbJm_ucY-uMGAxoohGZ8AwwB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;data landed in s3&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAE_dm6okTFHs6TCPnRfFcmAdBo-yIVHs7YB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.evernote.com/l/AAFejlfQEE1J1LfEmGJ-hra2Tn3FRWgKzVsB/image.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;resources&#34;&gt;Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/appflow/integrations/#Veeva&#34;&gt;AppFlow Saas Applications | Veeva Vault&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.veevavault.com/&#34;&gt;https://developer.veevavault.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
</item>
    
    <item>
<title>Cognito Federated to Salesforce and S3 Presigned URL</title>
<link>https://brianpfeil.com/post/cognito-federated-to-salesforce-and-s3-presigned-url/</link>
<pubDate>Thu, 13 Jun 2019 00:00:00 -0400</pubDate>
      
      <guid>https://brianpfeil.com/post/cognito-federated-to-salesforce-and-s3-presigned-url/</guid>
<description>&lt;div class=&#34;alert alert-info small bg-info&#34; role=&#34;alert&#34;&gt;
&lt;span class=&#34;text-muted&#34;&gt;code for article&lt;/span&gt;&amp;nbsp;&lt;a href=&#34;https://github.com/pfeilbr/cognito-federated-to-salesforce-and-s3-presigned-url-playground&#34; target=&#34;_blank&#34;&gt;&lt;i class=&#34;fab fa-github fa-sm&#34;&gt;&lt;/i&gt;&amp;nbsp;pfeilbr/cognito-federated-to-salesforce-and-s3-presigned-url-playground&lt;/a&gt;
&lt;/div&gt;
&lt;h2 id=&#34;login-with-cognito-federated-to-salesforce-example&#34;&gt;Login with Cognito Federated to Salesforce Example&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;see &lt;a href=&#34;index.html&#34;&gt;&lt;code&gt;index.html&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;see &lt;code&gt;~/Dropbox/notes/static-s3-cognito-authentication.md&lt;/code&gt; on local machine also for greater detail on setup&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# local dev&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# start server.  serves static files from current directory &amp;#39;.&amp;#39;.  listens on ssl 443&lt;/span&gt;
sudo node server.js
open https://localhost

&lt;span class=&#34;c1&#34;&gt;# on s3&lt;/span&gt;
open https://pfeil-static-site-01.s3.amazonaws.com/index.html

&lt;span class=&#34;c1&#34;&gt;# on cloudfront&lt;/span&gt;
open https://d3tz189emgpc7c.cloudfront.net/index.html

&lt;span class=&#34;c1&#34;&gt;# copy updated file to s3&lt;/span&gt;
aws s3 cp index.html s3://pfeil-static-site-01/index.html
&lt;span class=&#34;c1&#34;&gt;# invalidate cloudfront dist after copy&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# if any login issues&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# clear site data for https://pfeil-dev-ed.my.salesforce.com in chrome dev tools&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;pre-signed-url-example&#34;&gt;Pre-signed URL Example&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;see &lt;a href=&#34;index.js&#34;&gt;&lt;code&gt;index.js&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;node index.js&lt;/code&gt; outputs pre-signed url. (uses ~/.aws/credentials and pre-signed URL generated under that users context/permission)&lt;/li&gt;
&lt;li&gt;PUT / upload file to S3 via &lt;code&gt;curl -X PUT -T hello.txt -L &#39;&amp;lt;pre-signed url&amp;gt;&#39;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
</item>
    
    <item>
<title>S3 Website</title>
<link>https://brianpfeil.com/post/s3-website/</link>
<pubDate>Thu, 17 Aug 2017 00:00:00 -0400</pubDate>
      
      <guid>https://brianpfeil.com/post/s3-website/</guid>
<description>&lt;div class=&#34;alert alert-info small bg-info&#34; role=&#34;alert&#34;&gt;
&lt;span class=&#34;text-muted&#34;&gt;code for article&lt;/span&gt;&amp;nbsp;&lt;a href=&#34;https://github.com/pfeilbr/s3-website-playground&#34; target=&#34;_blank&#34;&gt;&lt;i class=&#34;fab fa-github fa-sm&#34;&gt;&lt;/i&gt;&amp;nbsp;pfeilbr/s3-website-playground&lt;/a&gt;
&lt;/div&gt;
&lt;p&gt;learn &lt;a href=&#34;https://github.com/klaemo/s3-website&#34;&gt;s3-website&lt;/a&gt; npm module&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;usage session&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# install deps&lt;/span&gt;
npm install

&lt;span class=&#34;c1&#34;&gt;# create static website&lt;/span&gt;
./node_modules/s3-website/s3-website.js create 

&lt;span class=&#34;c1&#34;&gt;# deploy static website&lt;/span&gt;
com.brianpfeil.s3-website-playground.site01
./node_modules/s3-website/s3-website.js deploy

&lt;span class=&#34;c1&#34;&gt;# view &lt;/span&gt;
open http://com.brianpfeil.s3-website-playground.site01.s3-website-us-east-1.amazonaws.com

&lt;span class=&#34;c1&#34;&gt;# NOTE: using `./node_modules/s3-website/s3-website.js` to avoid global install and&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# doesn&amp;#39;t work with `npx` because of https://www.evernote.com/l/AAH8gou8OCZKF6rfnqA2Tom3BU7c0xuFTM0B/image.png&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
</item>
    
  </channel>
</rss>